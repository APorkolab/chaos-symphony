<!doctype html>
<meta charset="utf-8">
<h3>Chaos Rules</h3>
<label>failRate <input id="fail" type="range" min="0" max="1" step="0.01"></label>
<span id="failv"></span><br>
<label>delayMs <input id="delay" type="number" min="0" step="50"></label><br>
<label>outOfOrder <input id="ooo" type="range" min="0" max="1" step="0.01"></label>
<span id="ooov"></span><br>
<button onclick="save()">Save</button>
<script>
	async function load() {
		let r = await fetch('/api/chaos/rules'); let j = await r.json();
		fail.value = j.failRate; delay.value = j.delayMs; ooo.value = j.outOfOrderRate;
		failv.textContent = j.failRate; ooov.textContent = j.outOfOrderRate;
	}
	async function save() {
		let b = { failRate: parseFloat(fail.value), delayMs: parseInt(delay.value), outOfOrderRate: parseFloat(ooo.value) };
		await fetch('/api/chaos/rules', { method: 'PUT', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(b) });
		await load();
	}
	[fail, ooo].forEach(e => e.addEventListener('input', () => { failv.textContent = fail.value; ooov.textContent = ooo.value; }));
	load();
</script>