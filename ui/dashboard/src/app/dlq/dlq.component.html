<div class="container mx-auto p-4">
  <h1 class="text-3xl font-bold mb-6">Dead-Letter Queue Management</h1>

  <div class="grid grid-cols-1 md:grid-cols-3 gap-8">

    <!-- DLQ Topics List -->
    <div class="md:col-span-1 bg-gray-800 p-4 rounded-lg shadow-md">
      <h2 class="text-xl font-semibold mb-4">DLQ Topics</h2>
      <ul>
        <li *ngFor="let topic of topics$ | async"
            (click)="selectTopic(topic)"
            class="p-3 rounded-md cursor-pointer hover:bg-gray-700"
            [class.bg-blue-600]="selectedTopic?.name === topic.name">
          <div class="flex justify-between items-center">
            <span class="font-semibold">{{ topic.name }}</span>
            <span class="bg-red-500 text-white text-xs font-bold px-2 py-1 rounded-full">
              {{ topic.messageCount }}
            </span>
          </div>
        </li>
      </ul>
    </div>

    <!-- Messages in Selected Topic -->
    <div class="md:col-span-2 bg-gray-800 p-4 rounded-lg shadow-md">
      <div *ngIf="selectedTopic; else noTopicSelected">
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-xl font-semibold">Messages in <span class="font-mono text-blue-400">{{ selectedTopic.name }}</span></h2>
          <button
            (click)="retryAllMessages()"
            class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-md transition duration-300">
            Retry All
          </button>
        </div>
        <div class="overflow-x-auto">
          <table class="min-w-full text-left">
            <thead class="bg-gray-700">
              <tr>
                <th class="p-3">Timestamp</th>
                <th class="p-3">Headers</th>
                <th class="p-3">Payload</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let message of messages$ | async" class="border-b border-gray-700">
                <td class="p-3 align-top font-mono text-sm">{{ message.timestamp | date:'medium' }}</td>
                <td class="p-3 align-top">
                  <pre class="text-xs bg-gray-900 p-2 rounded whitespace-pre-wrap">{{ message.headers | json }}</pre>
                </td>
                <td class="p-3 align-top">
                  <pre class="text-xs bg-gray-900 p-2 rounded whitespace-pre-wrap">{{ message.payload | json }}</pre>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <ng-template #noTopicSelected>
        <div class="flex items-center justify-center h-full">
          <p class="text-gray-400">Select a topic to see its messages.</p>
        </div>
      </ng-template>
    </div>
  </div>
</div>
